DECLARE @TableName varchar(150)
DECLARE @Id int

DECLARE cur CURSOR LOCAL FOR

SELECT name,id
FROM sysobjects
WHERE type = 'u' 
AND left(name,2) <> 'DD' 
AND left(name,2) <> 'dt'
ORDER BY name

OPEN cur
	FETCH NEXT FROM cur INTO @TableName, @Id
	WHILE @@FETCH_STATUS = 0
	BEGIN
	

		SELECT	TABLE_CATALOG AS [Catalog], TABLE_SCHEMA AS [TableSchema], TABLE_NAME AS [TableName],  COLUMN_NAME AS [ColumnName],
			ORDINAL_POSITION AS OrdinalPosition, COLUMN_DEFAULT AS DefaultValue,Convert(bit,(CASE IS_NULLABLE WHEN 'YES' THEN 1 ELSE 0 END)) AS IsNullible, DATA_TYPE AS Datatype,
			CHARACTER_MAXIMUM_LENGTH AS MaxLength,
			Convert(bit,(SELECT COLUMNPROPERTY(OBJECT_ID(@TableName), INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME, 'IsComputed'))) AS IsComputed ,
			Convert(bit,(SELECT COL_LENGTH(@TableName, INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME))) AS ColumnLength,
			Convert(bit,(SELECT COLUMNPROPERTY(OBJECT_ID(@TableName), INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME, 'IsIdentity'))) AS IsIdentity,
			Convert(bit,(SELECT COLUMNPROPERTY(OBJECT_ID(@TableName), INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME, 'IsRowGuidCol'))) AS IsRowGuidColumn,
			Convert(bit,(ISNULL((SELECT TOP 1 CASE INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE
					WHEN 'PRIMARY KEY' THEN 1
					END
				FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE INNER JOIN 
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS ON 
					INFORMATION_SCHEMA.KEY_COLUMN_USAGE.CONSTRAINT_NAME=
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_NAME
				WHERE INFORMATION_SCHEMA.KEY_COLUMN_USAGE.TABLE_NAME = @TableName
					AND INFORMATION_SCHEMA.KEY_COLUMN_USAGE.COLUMN_NAME = 
					INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME
					AND INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE = 'PRIMARY KEY'), 0))) AS IsPrimaryKey,
			Convert(bit,(ISNULL((SELECT TOP 1 CASE INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE
					WHEN 'FOREIGN KEY' THEN 1
					END
				FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE INNER JOIN 
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS ON 
					INFORMATION_SCHEMA.KEY_COLUMN_USAGE.CONSTRAINT_NAME=
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_NAME
				WHERE INFORMATION_SCHEMA.KEY_COLUMN_USAGE.TABLE_NAME = @TableName
					AND INFORMATION_SCHEMA.KEY_COLUMN_USAGE.COLUMN_NAME = 
					INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME
					AND INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE = 'FOREIGN KEY'), 0))) AS IsForeignKey, 
			Convert(bit,(ISNULL((SELECT TOP 1 CASE INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE
					WHEN 'UNIQUE' THEN 1
					END
				FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE INNER JOIN 
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS ON 
					INFORMATION_SCHEMA.KEY_COLUMN_USAGE.CONSTRAINT_NAME=
					INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_NAME
				WHERE INFORMATION_SCHEMA.KEY_COLUMN_USAGE.TABLE_NAME = @TableName
					AND INFORMATION_SCHEMA.KEY_COLUMN_USAGE.COLUMN_NAME = 
					INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME
					AND INFORMATION_SCHEMA.TABLE_CONSTRAINTS.CONSTRAINT_TYPE = 'UNIQUE'), 0))) AS HasUniqueConstraint
		FROM INFORMATION_SCHEMA.COLUMNS
		WHERE TABLE_NAME = @TableName and TABLE_SCHEMA = OBJECT_SCHEMA_NAME(@Id)
		FETCH NEXT FROM cur INTO @TableName, @Id
	END
CLOSE cur
DEALLOCATE cur